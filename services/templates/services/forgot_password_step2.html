{% extends 'services/base.html' %}

{% block title %}Verify OTP - ServiceHub{% endblock %}

{% block extra_css %}
<style>
    .otp-input {
        font-size: 2.5rem;
        letter-spacing: 1.5rem;
        text-align: center;
        font-weight: bold;
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center py-8">
    <div class="max-w-lg w-full px-4">
        <div class="card glass-effect">
            <div class="card-body">
                <div class="text-center mb-8">
                    <div class="w-28 h-28 rounded-full bg-gradient-to-br from-success to-info flex items-center justify-center mx-auto mb-4 animate-bounce">
                        <i class="fas fa-sms text-6xl text-white"></i>
                    </div>
                    <h2 class="text-4xl font-bold mb-3">Enter OTP</h2>
                    <p class="text-lg text-base-content/70 mb-2">We sent a code to</p>
                    <div class="badge badge-primary badge-lg text-lg px-6 py-4">
                        <i class="fas fa-phone mr-2"></i>{{ phone_number }}
                    </div>
                </div>
                
                <form method="POST">
                    {% csrf_token %}
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-bold text-center w-full text-xl">
                                Enter 6-Digit OTP
                            </span>
                        </label>
                        <input 
                            type="text" 
                            name="otp" 
                            id="otpInput"
                            class="input input-bordered input-lg w-full otp-input" 
                            maxlength="6" 
                            placeholder="000000"
                            required
                            autofocus
                        >
                        <label class="label">
                            <span class="label-text-alt text-center w-full text-warning font-semibold">
                                <i class="fas fa-clock mr-1"></i>Valid for 10 minutes
                            </span>
                        </label>
                    </div>
                    
                    <!-- Console Reminder -->
                    <div class="alert alert-warning mt-6">
                        <i class="fas fa-terminal text-2xl"></i>
                        <div class="flex-1">
                            <p class="font-bold text-lg">üîç Check Your Terminal!</p>
                            <p class="text-sm mt-1">Look for the OTP in your <strong>console/terminal</strong> where you ran <code>python manage.py runserver</code></p>
                            <div class="bg-base-300 p-2 rounded mt-2 text-xs font-mono">
                                üîê OTP CODE: XXXXXX
                            </div>
                        </div>
                    </div>
                    
                    <!-- Submit Button -->
                    <div class="form-control mt-6">
                        <button type="submit" class="btn btn-success btn-lg btn-block hover-lift">
                            <i class="fas fa-check-circle mr-2"></i>
                            Verify OTP
                        </button>
                    </div>
                </form>
                
                <div class="divider">Having trouble?</div>
                
                <div class="grid grid-cols-2 gap-3">
                    <a href="{% url 'forgot_password_step1' user_type=user_type %}" 
                       class="btn btn-outline btn-warning">
                        <i class="fas fa-redo mr-2"></i>
                        Resend OTP
                    </a>
                    <a href="{% url 'login_choice' %}" class="btn btn-ghost">
                        <i class="fas fa-times mr-2"></i>
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const otpInput = document.getElementById('otpInput');
        
        // Only allow numbers
        otpInput.addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
        
        // Prevent non-numeric input
        otpInput.addEventListener('keypress', function(e) {
            if (e.key < '0' || e.key > '9') {
                e.preventDefault();
            }
        });
    });
</script>
{% endblock %}